<div class="card mb-3">
	<div class="card-header fw-bold">
		Publicación
	</div>
	<div class="card-body">
		<div class="mb-3">
			<label for="name" class="form-label">Nombre de la publicación</label>
			<input type="text" class="form-control" id="name" placeholder="Escriba el nombre de la lista">
		  </div>
	</div>
</div>

<div class="card">
	<div class="card-header fw-bold d-flex align-items-center">
		<span>Cartas</span>
		<div class="btn-toolbar justify-content-end flex-grow-1" role="toolbar">
			<div class="btn-group card-item-actions border me-2" role="group">
				<button type="button" class="btn btn-sm btn-primary" >
					<fa-icon [icon]="sortUpIcon"/>
				</button>
				<button type="button" class="btn btn-sm btn-primary">
					<fa-icon [icon]="sortDownIcon"/>
				</button>
			</div>
			<button type="button" class="btn btn-sm btn-success" >
				<fa-icon [icon]="imageIcon"/>
			</button>
		</div>
	</div>
	<div class="card-body p-0">
		@if (post$ | async; as post) {
			<div class="card-grid">
				@for(card of cards(); track card) {
				<div class="card-item-container col-12 col-md-6 col-xl-4">
					<div class="d-flex">
						<div class="img-container card-reduced-img-container-height text-center">
							<img [src]="card.image_url" onerror="this.onerror=null;this.src='assets/card-back.png';" />
						</div>

						<div class="card-item-details font-small d-flex-grow-1 ">
							<small class="card-item-details-name fw-bold mb-1">{{ card.name }}</small>
							<small class="card-item-details-expansion text-muted">{{ card.expansion_name }}</small>
							<small class="card-item-details-code text-muted">{{ card.code.default + ' # ' + card.rarity_name }}</small>

							<small class="card-item-details-price fw-bold mt-2">
								Precio: <span class="text-primary ms-2">{{ getPrice(card) | currency }}</span>
							</small>
							@if (card.multiplier > 1) {
								<small class="card-item-details-price fw-bold mt-1">
									Subtotal: <span class="text-primary ms-2">{{ getPrice(card) * card.multiplier | currency }}</span>
								</small>
							}
							<div class="row g-0 mt-auto">
								<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
									<div class="btn-group card-item-actions border me-2" role="group">
										<button type="button" class="btn btn-sm" (click)="changeMultiplier(card, -1)">
											<fa-icon [icon]="minusIcon"/>
										</button>
										<button type="button" class="btn btn-sm border-0" disabled>
											{{ card.multiplier }}
										</button>
										<button type="button" class="btn btn-sm" (click)="changeMultiplier(card, 1)">
											<fa-icon [icon]="plusIcon"/>
										</button>
									</div>
									<button type="button" class="btn btn-sm btn-primary me-2">
										<fa-icon [icon]="viewIcon"/>
									</button>
									<button type="button" class="btn btn-sm bg-danger text-white" (click)="removeCard(card)">
										<fa-icon [icon]="trashIcon"/>
									</button>
								</div>
							</div>
						</div>
					</div>

				</div>
				}
			</div>
		}
		@if(noData) {
			<div class="no-cards text-center text-muted">
				<p class="card-text">
					No has agregado ninguna carta.
				</p>
			</div>
		}
	</div>
	<div class="card-footer">
		<p class="card-text fw-bold text-end">
			TOTAL:  <span class="ms-2">{{ total() | currency }}</span>
		</p>
	</div>
</div>